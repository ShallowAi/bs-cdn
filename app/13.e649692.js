(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{132:function(e,t,n){var a=n(321);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n(8).default)("1612bb34",a,!0,{})},320:function(e,t,n){"use strict";var a=n(132);n.n(a).a},321:function(e,t,n){(e.exports=n(7)(!1)).push([e.i,".operations-menu{margin-left:-35px}.row-at-bottom{margin-top:-100px}",""])},363:function(e,t,n){"use strict";n.r(t);var a=n(83),r=(n(78),n(4)),i=n(69),s=n(91);function o(e,t,n,a,r,i,s){try{var o=e[i](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(a,r)}function l(e){return function(){var t=this,n=arguments;return new Promise(function(a,r){var i=e.apply(t,n);function s(e){o(i,a,r,s,l,"next",e)}function l(e){o(i,a,r,s,l,"throw",e)}s(void 0)})}}var c={name:"UsersManagement",components:{VueGoodTable:a.a},filters:{humanizePermission(e){switch(e.permission){case-1:return Object(r.a)("admin.banned");case 0:return Object(r.a)("admin.normal");case 1:return Object(r.a)("admin.admin");case 2:return Object(r.a)("admin.superAdmin");default:return""}},playersLink:e=>"".concat(blessing.base_url,"/admin/players?uid=").concat(e.uid)},mixins:[i.a,s.a],data(){return{users:[],columns:[{field:"uid",label:"UID",type:"number"},{field:"email",label:this.$t("general.user.email")},{field:"nickname",label:this.$t("general.user.nickname"),width:"150px"},{field:"score",label:this.$t("general.user.score"),type:"number",width:"102px"},{field:"players_count",label:this.$t("admin.playersCount"),type:"number"},{field:"permission",label:this.$t("admin.permission"),globalSearchDisabled:!0},{field:"verified",label:this.$t("admin.verification"),type:"boolean",globalSearchDisabled:!0},{field:"register_at",label:this.$t("general.user.register-at")},{field:"operations",label:this.$t("admin.operationsTitle"),sortable:!1,globalSearchDisabled:!0}]}},beforeMount(){this.fetchData()},methods:{fetchData(){var e=this;return l(function*(){const t=yield e.$http.get("/admin/user-data".concat(location.search),!location.search&&e.serverParams),n=t.data,a=t.totalRecords;e.totalRecords=a,e.users=n})()},changeEmail(e){var t=this;return l(function*(){let n;try{n=(yield t.$prompt(t.$t("admin.newUserEmail"),{inputValue:e.email,inputValidator:e=>!!e||t.$t("auth.emptyEmail")})).value}catch(e){return}const a=yield t.$http.post("/admin/users?action=email",{uid:e.uid,email:n}),r=a.errno,i=a.msg;0===r?(e.email=n,t.$message.success(i)):t.$message.warning(i)})()},toggleVerification(e){var t=this;return l(function*(){const n=yield t.$http.post("/admin/users?action=verification",{uid:e.uid}),a=n.errno,r=n.msg;0===a?(e.verified=!e.verified,t.$message.success(r)):t.$message.warning(r)})()},changeNickName(e){var t=this;return l(function*(){let n;try{n=(yield t.$prompt(t.$t("admin.newUserNickname"),{inputValue:e.nickname,inputValidator:e=>!!e||t.$t("auth.emptyNickname")})).value}catch(e){return}const a=yield t.$http.post("/admin/users?action=nickname",{uid:e.uid,nickname:n}),r=a.errno,i=a.msg;0===r?(e.nickname=n,t.$message.success(i)):t.$message.warning(i)})()},changePassword(e){var t=this;return l(function*(){let n;try{n=(yield t.$prompt(t.$t("admin.newUserPassword"),{inputType:"password"})).value}catch(e){return}const a=yield t.$http.post("/admin/users?action=password",{uid:e.uid,password:n}),r=a.errno,i=a.msg;0===r?t.$message.success(i):t.$message.warning(i)})()},changeScore(e){var t=this;return l(function*(){let n;try{n=(yield t.$prompt(t.$t("admin.newScore"),{inputType:"number",inputValue:e.score})).value}catch(e){return}const a=Number.parseInt(n),r=yield t.$http.post("/admin/users?action=score",{uid:e.uid,score:a}),i=r.errno,s=r.msg;0===i?(e.score=a,t.$message.success(s)):t.$message.warning(s)})()},changePermission(e){var t=this;return l(function*(){const n=e.operations,a=[t.$t("admin.banned"),t.$t("admin.normal")];2===n&&a.push(t.$t("admin.admin"));const r=t.$createElement,i=r("div",null,[r("span",null,t.$t("admin.newPermission")),r("select",{attrs:{selectedIndex:0}},a.map(e=>r("option",null,e)))]);try{yield t.$msgbox({message:i,showCancelButton:!0})}catch(e){return}const s=i.children[1].elm.selectedIndex-1,o=yield t.$http.post("/admin/users?action=permission",{uid:e.uid,permission:s}),l=o.errno,c=o.msg;0===l?(e.permission=+s,t.$message.success(c)):t.$message.warning(c)})()},deleteUser(e){var t=this;return l(function*(){let n=e.uid,a=e.originalIndex;try{yield t.$confirm(t.$t("admin.deleteUserNotice"),{type:"warning"})}catch(e){return}const r=yield t.$http.post("/admin/users?action=delete",{uid:n}),i=r.errno,s=r.msg;0===i?(t.$delete(t.users,a),t.$message.success(s)):t.$message.warning(s)})()}}},d=(n(320),n(58)),u=Object(d.a)(c,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"content"},[n("vue-good-table",{attrs:{mode:"remote",rows:e.users,"total-rows":e.totalRecords||e.users.length,columns:e.columns,"search-options":e.tableOptions.search,"pagination-options":e.tableOptions.pagination,"style-class":"vgt-table striped"},on:{"on-page-change":e.onPageChange,"on-sort-change":e.onSortChange,"on-search":e.onSearch,"on-per-page-change":e.onPerPageChange},scopedSlots:e._u([{key:"table-row",fn:function(t){return["email"===t.column.field?n("span",[e._v("\n        "+e._s(t.formattedRow[t.column.field])+"\n        "),n("a",{attrs:{title:e.$t("admin.changeEmail"),"data-test":"email"},on:{click:function(n){return e.changeEmail(t.row)}}},[n("i",{staticClass:"fas fa-edit btn-edit"})])]):"nickname"===t.column.field?n("span",[e._v("\n        "+e._s(t.formattedRow[t.column.field])+"\n        "),n("a",{attrs:{title:e.$t("admin.changeNickName"),"data-test":"nickname"},on:{click:function(n){return e.changeNickName(t.row)}}},[n("i",{staticClass:"fas fa-edit btn-edit"})])]):"score"===t.column.field?n("span",[e._v("\n        "+e._s(t.formattedRow[t.column.field])+"\n        "),n("a",{attrs:{title:e.$t("admin.changeScore"),"data-test":"score"},on:{click:function(n){return e.changeScore(t.row)}}},[n("i",{staticClass:"fas fa-edit btn-edit"})])]):"players_count"===t.column.field?n("span",[n("a",{attrs:{href:e._f("playersLink")(t.row),title:e.$t("admin.inspectHisPlayers"),"data-toggle":"tooltip","data-placement":"right"}},[e._v(e._s(t.formattedRow[t.column.field]))])]):"permission"===t.column.field?n("span",[n("span",[e._v(e._s(e._f("humanizePermission")(t.row)))]),e._v(" "),t.row.permission<1||2===t.row.operations&&t.row.permission<2?n("a",{attrs:{title:e.$t("admin.changePermission"),"data-test":"permission"},on:{click:function(n){return e.changePermission(t.row)}}},[n("i",{staticClass:"fas fa-edit btn-edit"})]):e._e()]):"verified"===t.column.field?n("span",[t.row.verified?n("span",{directives:[{name:"t",rawName:"v-t",value:"admin.verified",expression:"'admin.verified'"}]}):n("span",{directives:[{name:"t",rawName:"v-t",value:"admin.unverified",expression:"'admin.unverified'"}]}),e._v(" "),n("a",{attrs:{title:e.$t("admin.toggleVerification"),"data-test":"verification"},on:{click:function(n){return e.toggleVerification(t.row)}}},[n("i",{staticClass:"fas btn-edit",class:{"fa-toggle-on":t.row.verified,"fa-toggle-off":!t.row.verified},staticStyle:{"font-size":"18px"}})])]):"operations"===t.column.field?n("div",[n("el-button",{attrs:{size:"medium"},on:{click:function(n){return e.changePassword(t.row)}}},[e._v("\n          "+e._s(e.$t("admin.changePassword"))+"\n        ")]),e._v(" "),n("el-button",{attrs:{disabled:t.row.permission>=2||1===t.row.operations&&t.row.permission>=1,type:"danger",size:"medium","data-test":"deleteUser"},on:{click:function(n){return e.deleteUser(t.row)}}},[e._v("\n          "+e._s(e.$t("admin.deleteUser"))+"\n        ")])],1):n("span",{domProps:{textContent:e._s(t.formattedRow[t.column.field])}})]}}])})],1)},[],!1,null,null,null);t.default=u.exports},69:function(e,t,n){"use strict";var a=n(0);t.a=a.default.extend({data(){return{tableOptions:{search:{enabled:!0,placeholder:this.$t("vendor.datatable.search")},pagination:{enabled:!0,nextLabel:this.$t("vendor.datatable.next"),prevLabel:this.$t("vendor.datatable.prev"),rowsPerPageLabel:this.$t("vendor.datatable.rowsPerPage"),allLabel:this.$t("vendor.datatable.all"),ofLabel:this.$t("vendor.datatable.of")}}}}})},7:function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=function(e,t){var n=e[1]||"",a=e[3];if(!a)return n;if(t&&"function"==typeof btoa){var r=(s=a,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),i=a.sources.map(function(e){return"/*# sourceURL="+a.sourceRoot+e+" */"});return[n].concat(i).concat([r]).join("\n")}var s;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var a={},r=0;r<this.length;r++){var i=this[r][0];null!=i&&(a[i]=!0)}for(r=0;r<e.length;r++){var s=e[r];null!=s[0]&&a[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),t.push(s))}},t}},8:function(e,t,n){"use strict";function a(e,t){for(var n=[],a={},r=0;r<t.length;r++){var i=t[r],s=i[0],o={id:e+":"+r,css:i[1],media:i[2],sourceMap:i[3]};a[s]?a[s].parts.push(o):n.push(a[s]={id:s,parts:[o]})}return n}n.r(t),n.d(t,"default",function(){return f});var r="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!r)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},s=r&&(document.head||document.getElementsByTagName("head")[0]),o=null,l=0,c=!1,d=function(){},u=null,m="data-vue-ssr-id",p="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function f(e,t,n,r){c=n,u=r||{};var s=a(e,t);return h(s),function(t){for(var n=[],r=0;r<s.length;r++){var o=s[r];(l=i[o.id]).refs--,n.push(l)}t?h(s=a(e,t)):s=[];for(r=0;r<n.length;r++){var l;if(0===(l=n[r]).refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete i[l.id]}}}}function h(e){for(var t=0;t<e.length;t++){var n=e[t],a=i[n.id];if(a){a.refs++;for(var r=0;r<a.parts.length;r++)a.parts[r](n.parts[r]);for(;r<n.parts.length;r++)a.parts.push(v(n.parts[r]));a.parts.length>n.parts.length&&(a.parts.length=n.parts.length)}else{var s=[];for(r=0;r<n.parts.length;r++)s.push(v(n.parts[r]));i[n.id]={id:n.id,refs:1,parts:s}}}}function g(){var e=document.createElement("style");return e.type="text/css",s.appendChild(e),e}function v(e){var t,n,a=document.querySelector("style["+m+'~="'+e.id+'"]');if(a){if(c)return d;a.parentNode.removeChild(a)}if(p){var r=l++;a=o||(o=g()),t=w.bind(null,a,r,!1),n=w.bind(null,a,r,!0)}else a=g(),t=function(e,t){var n=t.css,a=t.media,r=t.sourceMap;a&&e.setAttribute("media",a);u.ssrId&&e.setAttribute(m,t.id);r&&(n+="\n/*# sourceURL="+r.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,a),n=function(){a.parentNode.removeChild(a)};return t(e),function(a){if(a){if(a.css===e.css&&a.media===e.media&&a.sourceMap===e.sourceMap)return;t(e=a)}else n()}}var b,y=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")});function w(e,t,n,a){var r=n?"":a.css;if(e.styleSheet)e.styleSheet.cssText=y(t,r);else{var i=document.createTextNode(r),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(i,s[t]):e.appendChild(i)}}},91:function(e,t,n){"use strict";var a=n(0);function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}t.a=a.default.extend({data:()=>({columns:[{field:"id"}],totalRecords:0,serverParams:{sortField:"id",sortType:"asc",page:1,perPage:10,search:""}}),created(){this.serverParams.sortField=this.columns[0].field},methods:{fetchData:()=>Promise.resolve(),onPageChange(e){this.serverParams.page=e.currentPage,this.fetchData()},onPerPageChange(e){this.serverParams.perPage=e.currentPerPage,this.fetchData()},onSortChange(e){let t=r(e,1)[0];this.serverParams.sortType=t.type,this.serverParams.sortField=t.field,this.fetchData()},onSearch(e){this.serverParams.search=e.searchTerm,this.fetchData()}}})}}]);