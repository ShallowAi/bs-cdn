(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{140:function(e,t,i){var s=i(350);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);(0,i(8).default)("6b6fc155",s,!0,{})},349:function(e,t,i){"use strict";var s=i(140);i.n(s).a},350:function(e,t,i){(e.exports=i(7)(!1)).push([e.i,".file-dnd{min-height:256px;margin-bottom:15px;border:1px solid #ddd;border-radius:2px;display:flex;justify-content:center;align-items:center}.file-dnd h3{color:#aaa}.bottom-notice{margin-top:10px}",""])},369:function(e,t,i){"use strict";i.r(t);var s=i(0),a=i(346),l=i.n(a),n=(i(347),i(348)),o=i.n(n);function r(e,t,i,s,a,l,n){try{var o=e[l](n),r=o.value}catch(e){return void i(e)}o.done?t(r):Promise.resolve(r).then(s,a)}s.default.use(o.a);var c={name:"Upload",components:{Previewer:()=>Promise.all([i.e(2),i.e(1)]).then(i.bind(null,380)),FileUpload:l.a},data:()=>({name:"",type:"steve",isPrivate:!1,files:[],texture:"",uploading:!1,textureNameRule:blessing.extra.rule,privacyNotice:blessing.extra.privacyNotice,scorePublic:blessing.extra.scorePublic,scorePrivate:blessing.extra.scorePrivate,award:blessing.extra.award,contentPolicy:blessing.extra.contentPolicy,width2d:64}),computed:{scoreCost(){return(Math.round(this.files[0].size/1024)||1)*(this.isPrivate?this.scorePrivate:this.scorePublic)},hasFile(){return this.files[0]}},methods:{upload(){var e,t=this;return(e=function*(){if(!t.hasFile)return void t.$message.error(t.$t("skinlib.emptyUploadFile"));if(!t.name)return void t.$message.error(t.$t("skinlib.emptyTextureName"));if(!/image\/(x-)?png/.test(t.files[0].type))return void t.$message.error(t.$t("skinlib.fileExtError"));const e=new FormData;e.append("name",t.name),e.append("type",t.type),e.append("file",t.files[0].file,t.files[0].name),e.append("public",!t.isPrivate),t.uploading=!0;const i=yield t.$http.post("/skinlib/upload",e),s=i.errno,a=i.msg,l=i.tid;0===s?(t.$message.success(a),setTimeout(()=>{window.location="".concat(blessing.base_url,"/skinlib/show/").concat(l)},1e3)):(t.$message.error(a),t.uploading=!1)},function(){var t=this,i=arguments;return new Promise(function(s,a){var l=e.apply(t,i);function n(e){r(l,s,a,n,o,"next",e)}function o(e){r(l,s,a,n,o,"throw",e)}n(void 0)})})()},inputFile(e){if(!e)return;if(!this.name){const t=/(.*)\.png$/i.exec(e.name);this.name=t?t[1]:e.name}this.texture=URL.createObjectURL(e.file);const t=new Image;t.src=this.texture,t.onload=(()=>this.width2d=t.width>400?400:t.width)},remove(){this.$refs.upload.clear(),this.texture=""},showContentPolicy(){this.$alert(this.contentPolicy,{dangerouslyUseHTMLString:!0})}}},u=(i(349),i(58)),p=Object(u.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",{staticClass:"content"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-6"},[i("div",{staticClass:"box box-primary"},[i("div",{staticClass:"box-body"},[i("div",{staticClass:"form-group"},[i("label",{directives:[{name:"t",rawName:"v-t",value:"skinlib.upload.texture-name",expression:"'skinlib.upload.texture-name'"}],attrs:{for:"name"}}),e._v(" "),i("el-input",{attrs:{placeholder:e.textureNameRule,clearable:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),e._v(" "),i("div",{staticClass:"form-group"},[i("label",{directives:[{name:"t",rawName:"v-t",value:"skinlib.upload.texture-type",expression:"'skinlib.upload.texture-type'"}]}),e._v(" "),i("br"),e._v(" "),i("el-radio",{attrs:{label:"steve"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[e._v("Steve")]),e._v(" "),i("el-radio",{attrs:{label:"alex"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[e._v("Alex")]),e._v(" "),i("el-radio",{attrs:{label:"cape"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[e._v(e._s(e.$t("general.cape")))])],1),e._v(" "),i("div",{staticClass:"form-group"},[i("label",{directives:[{name:"t",rawName:"v-t",value:"skinlib.upload.select-file",expression:"'skinlib.upload.select-file'"}],attrs:{for:"file"}}),e._v(" "),i("div",{staticClass:"file-dnd"},[e.hasFile?i("img",{attrs:{src:e.texture,width:e.width2d}}):i("h3",{directives:[{name:"t",rawName:"v-t",value:"skinlib.upload.dropZone",expression:"'skinlib.upload.dropZone'"}]})]),e._v(" "),i("file-upload",{ref:"upload",attrs:{extensions:"png",accept:"image/png,image/x-png",drop:".file-dnd"},on:{"input-file":e.inputFile},model:{value:e.files,callback:function(t){e.files=t},expression:"files"}},[i("el-button",{attrs:{type:"primary",size:"medium"}},[e._v("\n                "+e._s(e.$t("skinlib.upload.select-file"))+"\n              ")])],1),e._v(" "),i("el-button",{directives:[{name:"show",rawName:"v-show",value:e.hasFile,expression:"hasFile"}],staticClass:"pull-right",attrs:{size:"medium","data-test":"remove"},on:{click:e.remove}},[i("i",{staticClass:"fas fa-trash-alt"}),e._v("\n              "+e._s(e.$t("skinlib.upload.remove"))+"\n            ")])],1),e._v(" "),e.contentPolicy?i("a",{attrs:{href:"#"},on:{click:e.showContentPolicy}},[e._v("\n            "+e._s(e.$t("skinlib.showContentPolicy"))+"\n          ")]):e._e()]),e._v(" "),i("div",{staticClass:"box-footer"},[i("el-switch",{staticClass:"pull-right",attrs:{"active-text":e.$t("skinlib.upload.set-as-private"),title:e.$t("skinlib.upload.privacy-notice")},model:{value:e.isPrivate,callback:function(t){e.isPrivate=t},expression:"isPrivate"}}),e._v(" "),e.uploading?i("el-button",{attrs:{type:"success",size:"medium",disabled:""}},[i("i",{staticClass:"fa fa-spinner fa-spin"}),e._v(" "+e._s(e.$t("skinlib.uploading"))+"\n          ")]):i("el-button",{attrs:{type:"success",size:"medium"},on:{click:e.upload}},[e._v("\n            "+e._s(e.$t("skinlib.upload.button"))+"\n          ")]),e._v("\n          Â  "+e._s(e.hasFile&&e.$t("skinlib.upload.cost",{score:e.scoreCost}))+"\n          "),e.isPrivate?i("div",{staticClass:"callout callout-info bottom-notice"},[i("p",[e._v(e._s(e.privacyNotice))])]):e._e(),e._v(" "),!e.isPrivate&&e.award?i("div",{staticClass:"callout callout-success bottom-notice"},[i("p",[e._v(e._s(e.$t("skinlib.upload.award",{score:e.award})))])]):e._e()],1)])]),e._v(" "),i("div",{staticClass:"col-md-6"},[i("previewer",{attrs:{skin:"cape"!==e.type&&e.texture,cape:"cape"===e.type?e.texture:""}})],1)])])},[],!1,null,null,null);t.default=p.exports}}]);