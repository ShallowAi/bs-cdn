(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{105:function(e,t,s){var a=s(189);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,s(8).default)("0a5b786e",a,!0,{})},188:function(e,t,s){"use strict";var a=s(105);s.n(a).a},189:function(e,t,s){(e.exports=s(7)(!1)).push([e.i,".circle-gap{width:14%}.line-gap{height:12px}.score-title{margin-top:5px}@media (max-width:768px){.score-title{margin-top:12px}}#score{font-family:Minecraft;font-size:50px;text-align:center;margin-top:20px;cursor:help}.score-notice{font-size:smaller;margin-top:20px}",""])},367:function(e,t,s){"use strict";s.r(t);var a=s(0),r=(s(185),s(186)),i=s.n(r),n=s(187),o=s.n(n),c=s(93);function l(e,t,s,a,r,i,n){try{var o=e[i](n),c=o.value}catch(e){return void s(e)}o.done?t(c):Promise.resolve(c).then(a,r)}function u(e){return function(){var t=this,s=arguments;return new Promise(function(a,r){var i=e.apply(t,s);function n(e){l(i,a,r,n,o,"next",e)}function o(e){l(i,a,r,n,o,"throw",e)}n(void 0)})}}a.default.use(i.a);var d={name:"Dashboard",components:{EmailVerification:c.a},data:()=>({score:0,tweenedScore:0,lastSignAt:new Date,signAfterZero:!1,signGap:0,playersUsed:0,playersTotal:1,storageUsed:0,storageTotal:1,tween:null}),computed:{playersPercentage(){return this.playersUsed/this.playersTotal*100},storagePercentage(){return this.storageUsed/this.storageTotal*100},signRemainingTime(){if(this.signAfterZero){const e=(new Date).setHours(0,0,0,0),t=e+864e5;return this.lastSignAt.valueOf()<e?0:t-Date.now()}return this.lastSignAt.valueOf()+this.signGap-Date.now()},remainingTimeText(){const e=this.signRemainingTime/1e3/60;return e<60?this.$t("user.sign-remain-time",{time:~~e,unit:this.$t("user.time-unit-min")}):this.$t("user.sign-remain-time",{time:~~(e/60),unit:this.$t("user.time-unit-hour")})},canSign(){return this.signRemainingTime<=0},animatedScore(){return this.tweenedScore.toFixed(0)}},watch:{score(e){this.tween.to({tweenedScore:e},1e3).start()}},created(){this.tween=new o.a.Tween(this.$data)},beforeMount(){this.fetchScoreInfo()},mounted(){!function e(){requestAnimationFrame(e),o.a.update()}()},methods:{fetchScoreInfo(){var e=this;return u(function*(){const t=yield e.$http.get("/user/score-info");e.lastSignAt=new Date(t.user.lastSignAt),e.signAfterZero=t.signAfterZero,e.signGap=3600*t.signGapTime*1e3,e.playersUsed=t.stats.players.used,e.playersTotal=t.stats.players.total,e.storageUsed=t.stats.storage.used,e.storageTotal=t.stats.storage.total,e.score=t.user.score})()},sign(){var e=this;return u(function*(){const t=yield e.$http.post("/user/sign");0===t.errno?(e.$message.success(t.msg),e.score=t.score,e.lastSignAt=new Date,e.storageUsed=t.storage.used,e.storageTotal=t.storage.total):e.$message.warning(t.msg)})()}}},g=(s(188),s(58)),v=Object(g.a)(d,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("email-verification"),e._v(" "),s("div",{staticClass:"box"},[s("div",{staticClass:"box-header with-border"},[s("h3",{directives:[{name:"t",rawName:"v-t",value:"user.used.title",expression:"'user.used.title'"}],staticClass:"box-title"})]),e._v(" "),s("div",{staticClass:"box-body"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-1"}),e._v(" "),s("div",{staticClass:"col-md-6"},[s("table",{attrs:{border:"0"}},[s("tbody",[s("tr",[s("td",{staticClass:"text-center"},[s("b",{directives:[{name:"t",rawName:"v-t",value:"user.used.players",expression:"'user.used.players'"}]})]),e._v(" "),s("td",{staticClass:"circle-gap"}),e._v(" "),s("td",{staticClass:"text-center"},[s("b",{directives:[{name:"t",rawName:"v-t",value:"user.used.storage",expression:"'user.used.storage'"}]})])]),e._v(" "),s("tr",{staticClass:"line-gap"}),e._v(" "),s("tr",[s("td",[s("el-progress",{attrs:{type:"circle",percentage:~~e.playersPercentage,color:"#00429B"}})],1),e._v(" "),s("td",{staticClass:"circle-gap"}),e._v(" "),s("td",[s("el-progress",{attrs:{type:"circle",percentage:~~e.storagePercentage,color:"#008C95"}})],1)]),e._v(" "),s("tr",{staticClass:"line-gap"}),e._v(" "),s("tr",[s("td",{staticClass:"text-center"},[s("b",[e._v(e._s(e.playersUsed))]),e._v(" / "+e._s(e.playersTotal)+"\n                ")]),e._v(" "),s("td",{staticClass:"circle-gap"}),e._v(" "),s("td",{staticClass:"text-center"},[e.storageUsed>1024?[s("b",[e._v(e._s(~~(e.storageUsed/1024)))]),e._v(" / "+e._s(~~(e.storageTotal/1024))+" MB\n                  ")]:[s("b",[e._v(e._s(e.storageUsed))]),e._v(" / "+e._s(e.storageTotal)+" KB\n                  ")]],2)])])])]),e._v(" "),s("div",{staticClass:"col-md-4"},[s("p",{staticClass:"text-center score-title"},[s("strong",{directives:[{name:"t",rawName:"v-t",value:"user.cur-score",expression:"'user.cur-score'"}]})]),e._v(" "),s("p",{attrs:{id:"score","data-toggle":"modal","data-target":"#modal-score-instruction"}},[e._v("\n            "+e._s(e.animatedScore)+"\n          ")]),e._v(" "),s("p",{directives:[{name:"t",rawName:"v-t",value:"user.score-notice",expression:"'user.score-notice'"}],staticClass:"text-center score-notice"})])])]),e._v(" "),s("div",{staticClass:"box-footer"},[e.canSign?s("el-button",{staticClass:"btn btn-primary pull-left",attrs:{type:"primary",round:""},on:{click:e.sign}},[s("i",{staticClass:"far fa-calendar-check",attrs:{"aria-hidden":"true"}}),e._v("  "+e._s(e.$t("user.sign"))+"\n      ")]):s("el-button",{staticClass:"btn btn-primary pull-left",attrs:{type:"primary",round:"",title:e.$t("user.last-sign",{time:e.lastSignAt.toLocaleString()}),disabled:""}},[s("i",{staticClass:"far fa-calendar-check",attrs:{"aria-hidden":"true"}}),e._v("  \n        "+e._s(e.remainingTimeText)+"\n      ")])],1)])],1)},[],!1,null,null,null);t.default=v.exports},93:function(e,t,s){"use strict";function a(e,t,s,a,r,i,n){try{var o=e[i](n),c=o.value}catch(e){return void s(e)}o.done?t(c):Promise.resolve(c).then(a,r)}var r={name:"EmailVerification",data:()=>({verified:!blessing.extra.unverified,pending:!1}),methods:{resend(){var e,t=this;return(e=function*(){t.pending=!0;const e=yield t.$http.post("/user/email-verification"),s=e.errno,a=e.msg;0===s?t.$message.success(a):t.$message.error(a),t.pending=!1},function(){var t=this,s=arguments;return new Promise(function(r,i){var n=e.apply(t,s);function o(e){a(n,r,i,o,c,"next",e)}function c(e){a(n,r,i,o,c,"throw",e)}o(void 0)})})()}}},i=s(58),n=Object(i.a)(r,function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.verified?e._e():s("div",{staticClass:"callout callout-info"},[s("h4",[s("i",{staticClass:"fas fa-envelope"}),e._v(" "+e._s(e.$t("user.verification.title")))]),e._v(" "),s("p",[e._v("\n    "+e._s(e.$t("user.verification.message"))+"\n    "),e.pending?s("span",[s("i",{staticClass:"fas fa-spin fa-spinner"}),e._v("\n      "+e._s(e.$t("user.verification.sending"))+"\n    ")]):s("a",{attrs:{href:"#"},on:{click:e.resend}},[e._v("\n      "+e._s(e.$t("user.verification.resend"))+"\n    ")])])])},[],!1,null,null,null);t.a=n.exports}}]);